
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>6.1. Dot products, angles, and orthogonality &#8212; Linear Algebra for Data Workbook</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6.2. Gram–Schmidt and the QR Decomposition" href="basicLA_4_QR.html" />
    <link rel="prev" title="6. Geometry: angles, orthogonality, and projections" href="basicLA_4_chheader.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Linear Algebra for Data Workbook</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../overview.html">
   Welcome to Stat 89A
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Background
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="python_chheader.html">
   1. Python 101
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="python_basics.html">
     1.1. The Basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="python_numpy.html">
     1.2. Introduction to NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="python_plotting.html">
     1.3. MatPlotLib
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Basic Linear Algebra
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="basicLA_1_chheader.html">
   2. Matrices, vectors, and
   <span class="math notranslate nohighlight">
    \(\mathbb{R}^n\)
   </span>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="basicLA_1_introduction-to-norms.html">
     2.1. Introduction to Norms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="basicLA_1_norms-integration-monte-carlo.html">
     2.2. An application: approximating integrals with norms and Monte Carlo integration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="basicLA_1_lp-balls.html">
     2.3.
     <span class="math notranslate nohighlight">
      \(\ell_p\)
     </span>
     Balls
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="basicLA_1_classification-with-norms.html">
     2.4. An application: classifying data points using norms
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="basicLA_2_chheader.html">
   3. Basics of vectors and vector spaces
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="basicLA_2A_vectorspaces.html">
     3.1. Vectors and vector spaces
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="basicLA_3_chheader.html">
   4. Basics of matrices
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="basicLA_3_matrices-and-matrix-operations.html">
     4.1. Matrices and matrix operations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="basicLA_3_deconstructing.html">
     4.2. Deconstructing Matrix Multiplication
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="basicLA_3_powers_of_matrices.html">
     4.3. Taking Powers of Matrices
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="basicLA_3B_chheader.html">
   5. Matrices as transformations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="basicLA_3_linear_examples_new.html">
     5.1. Linear and Nonlinear Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="basicLA_3_matrices_and_linear_functions.html">
     5.2. Matrices and Linear Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="basicLA_3_injective-and-surjective-functions.html">
     5.3. Injective, surjective and invertible functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="basicLA_3_inverses.html">
     5.4. Left Inverses, Right Inverses, and Inverses
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="basicLA_3_changing_basis.html">
     5.5. Changing Basis
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="basicLA_4_chheader.html">
   6. Geometry: angles, orthogonality, and projections
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     6.1. Dot products, angles, and orthogonality
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="basicLA_4_QR.html">
     6.2. Gram–Schmidt and the QR Decomposition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="basicLA_4_QR_linear_systems.html">
     6.3. Solving linear systems with the QR decomposition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="basicLA_4_projections.html">
     6.4. Projections
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  The EVD, SVD and applications
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="eigenstuff_chheader.html">
   7. Eigenthings
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="eigenstuff_quadratic-forms.html">
     7.1. Quadratic forms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="eigenstuff_eigenthings.html">
     7.2. Eigenvalues and eigenvectors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="eigenstuff_eigenthings-special-matrices.html">
     7.3. The Eigenvalue decomposition for special types of matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="eigenstuff_qr-algorithm.html">
     7.4. The QR algorithm for finding eigenvalues and eigenvectors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="eigenstuff_SVD.html">
     7.5. The Singular Value Decomposition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="eigenstuff_low-rank-approximation.html">
     7.6. Low-rank approximation using the SVD
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="applications_chheader.html">
   8. Applications
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="applications_PCA.html">
     8.1. Principal Component Analysis (PCA)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="applications_spectral-clustering.html">
     8.2. Sprectral Clustering
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="applications_least-squares.html">
     8.3. Least Squares
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="applications_double-descent.html">
     8.4. The “double descent” phenomenon
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="../_sources/content/basicLA_4_dot-products-and-angles.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/content/basicLA_4_dot-products-and-angles.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/erichson/LinearAlgebra/master?urlpath=tree/content/basicLA_4_dot-products-and-angles.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dot-products-and-angles">
   6.1.1. Dot products and angles
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#review-of-dot-products-in-mathbb-r-n">
     6.1.1.1. Review of dot products in
     <span class="math notranslate nohighlight">
      \(\mathbb{R}^n\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#computing-angles-between-vectors-with-dot-products">
     6.1.1.2. Computing angles between vectors with dot products
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-gotcha">
     6.1.1.3. A gotcha
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#orthogonal-vectors-bases-and-matrices">
   6.1.2. Orthogonal vectors, bases, and matrices
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#orthogonality-between-two-subspaces">
     6.1.2.1. Orthogonality between two subspaces
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#orthogonal-and-orthonormal-sets-and-bases">
     6.1.2.2. Orthogonal and orthonormal sets and bases
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#orthogonal-matrices">
     6.1.2.3. Orthogonal matrices
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Dot products, angles, and orthogonality</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dot-products-and-angles">
   6.1.1. Dot products and angles
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#review-of-dot-products-in-mathbb-r-n">
     6.1.1.1. Review of dot products in
     <span class="math notranslate nohighlight">
      \(\mathbb{R}^n\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#computing-angles-between-vectors-with-dot-products">
     6.1.1.2. Computing angles between vectors with dot products
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-gotcha">
     6.1.1.3. A gotcha
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#orthogonal-vectors-bases-and-matrices">
   6.1.2. Orthogonal vectors, bases, and matrices
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#orthogonality-between-two-subspaces">
     6.1.2.1. Orthogonality between two subspaces
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#orthogonal-and-orthonormal-sets-and-bases">
     6.1.2.2. Orthogonal and orthonormal sets and bases
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#orthogonal-matrices">
     6.1.2.3. Orthogonal matrices
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="dot-products-angles-and-orthogonality">
<h1><span class="section-number">6.1. </span>Dot products, angles, and orthogonality<a class="headerlink" href="#dot-products-angles-and-orthogonality" title="Permalink to this headline">¶</a></h1>
<p>In this section, we review some of the basics of geometry in <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span>.</p>
<div class="section" id="dot-products-and-angles">
<h2><span class="section-number">6.1.1. </span>Dot products and angles<a class="headerlink" href="#dot-products-and-angles" title="Permalink to this headline">¶</a></h2>
<div class="section" id="review-of-dot-products-in-mathbb-r-n">
<h3><span class="section-number">6.1.1.1. </span>Review of dot products in <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span><a class="headerlink" href="#review-of-dot-products-in-mathbb-r-n" title="Permalink to this headline">¶</a></h3>
<p>One of the most important quantities we compute in linear algebra are <em>inner products</em>, also called the <em>dot product</em>.
For two vectors <span class="math notranslate nohighlight">\(\boldsymbol{x},\boldsymbol{y} \in \mathbb{R}^n\)</span>, the inner product is the number</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{x}^\top \boldsymbol{y} = \sum_{i=1}^n x_iy_i .
\]</div>
<p>Importantly, an inner product can be thought of as a linear function from <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span> to <span class="math notranslate nohighlight">\(\mathbb{R}\)</span>: if we fix <span class="math notranslate nohighlight">\(\boldsymbol{y}\in \mathbb{R}^n\)</span>, then the function <span class="math notranslate nohighlight">\(T_\boldsymbol{y}(\boldsymbol{x}) = \boldsymbol{x}^\top \boldsymbol{y}\)</span> is clearly linear, since for any <span class="math notranslate nohighlight">\(\boldsymbol{x},\boldsymbol{x}' \in \mathbb{R}^n\)</span> and <span class="math notranslate nohighlight">\(\alpha \in \mathbb{R}\)</span>, we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
T_\boldsymbol{y}(\boldsymbol{x} + \alpha \boldsymbol{x}') &amp;= (\boldsymbol{x}+\alpha \boldsymbol{x}')^\top \boldsymbol{y} = \sum_{i=1}^n (x_i + \alpha x'_i)y_i = \sum_{i=1}^n x_iy_i + \alpha\sum_{i=1}^nx'_iy_i \\&amp;= \boldsymbol{x}^\top \boldsymbol{y} + \alpha (\boldsymbol{x}')^\top \boldsymbol{y} = T_\boldsymbol{y}(\boldsymbol{x}) + \alpha T_\boldsymbol{y}(\boldsymbol{x}') .
\end{align*}
\end{split}\]</div>
<p>Dot products are also the basis of matrix multiplication: if <span class="math notranslate nohighlight">\(\boldsymbol{A} \in \mathbb{R}^{n\times m}\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{B}\in \mathbb{R}^{m\times p}\)</span> are matrices, and <span class="math notranslate nohighlight">\(\boldsymbol{a}_{1:},\dots, \boldsymbol{a}_{n:}\)</span> are the rows of <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{b}_{:1},\dots, \boldsymbol{b}_{:p}\)</span> are the columns of <span class="math notranslate nohighlight">\(\boldsymbol{B}\)</span>, then the <span class="math notranslate nohighlight">\((i,j)^{th}\)</span> element of <span class="math notranslate nohighlight">\(\boldsymbol{AB}\)</span> is just <span class="math notranslate nohighlight">\(\boldsymbol{a}_{i:}^\top \boldsymbol{b}_{:j}\)</span>.</p>
<p>In this chapter, however, we will be interested in a more geometric interpretation of dot products, namely that they are used to compute the angle between two vectors.</p>
</div>
<div class="section" id="computing-angles-between-vectors-with-dot-products">
<h3><span class="section-number">6.1.1.2. </span>Computing angles between vectors with dot products<a class="headerlink" href="#computing-angles-between-vectors-with-dot-products" title="Permalink to this headline">¶</a></h3>
<p>One of the most important facts about dot products is that they give us a way to compute the <em>angle</em> <span class="math notranslate nohighlight">\(\theta\)</span> between any two vectors <span class="math notranslate nohighlight">\(\boldsymbol{x},\boldsymbol{y}\in \mathbb{R}^n\)</span>.
This is due to the following important identity:</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{x}^\top \boldsymbol{y} = \|\boldsymbol{x}\|_2\|\boldsymbol{y}\|_2\cos(\theta)
\]</div>
<p>Therefore we have that the angle <span class="math notranslate nohighlight">\(\theta\)</span> can be found with</p>
<div class="math notranslate nohighlight">
\[
\theta = \arccos \left(\frac{\boldsymbol{x}^\top \boldsymbol{y}}{\|\boldsymbol{x}\|_2 \|\boldsymbol{y}\|_2}\right)
\]</div>
<p>Let’s see a few examples in Python.
First, let’s write a useful function which finds the angle between any two vectors <span class="math notranslate nohighlight">\(\boldsymbol{x}\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{y}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">angle_between_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="n">xty</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">norm_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">norm_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">xty</span><span class="o">/</span><span class="p">(</span><span class="n">norm_x</span><span class="o">*</span><span class="n">norm_y</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">theta</span>
</pre></div>
</div>
</div>
</div>
<p>In this function we first compute the dot product <span class="math notranslate nohighlight">\(\boldsymbol{x}^\top \boldsymbol{y}\)</span>, then the norms of <span class="math notranslate nohighlight">\(\boldsymbol{x}\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{y}\)</span>.
Finally, we use <code class="docutils literal notranslate"><span class="pre">np.arccos</span></code> to take the arccosine of <span class="math notranslate nohighlight">\(\boldsymbol{x}^\top \boldsymbol{y}\)</span> divided by <span class="math notranslate nohighlight">\(\|\boldsymbol{x}\|_2\|\boldsymbol{y}\|_2\)</span> to find the angle.</p>
<p>Let’s look at a simple example to make sure this works.
For example, consider <span class="math notranslate nohighlight">\(\boldsymbol{y} = (1,1)\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{x}= (1,0)\)</span>.
The vector <span class="math notranslate nohighlight">\( \boldsymbol{y}\)</span> is on the <span class="math notranslate nohighlight">\(45^\circ\)</span> line, and <span class="math notranslate nohighlight">\(\boldsymbol{x}\)</span> is on the <span class="math notranslate nohighlight">\(x\)</span>-axis, and so the angle between them should be <span class="math notranslate nohighlight">\(45^\circ\)</span>, or <span class="math notranslate nohighlight">\(\pi/4\)</span>.
Let’s first define and plot these vectors.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

<span class="n">origin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="o">*</span><span class="n">origin</span><span class="p">,</span> <span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="o">*</span><span class="n">origin</span><span class="p">,</span> <span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/basicLA_4_dot-products-and-angles_3_0.png" src="../_images/basicLA_4_dot-products-and-angles_3_0.png" />
</div>
</div>
<p>As expected, the two vectors appear to be at a <span class="math notranslate nohighlight">\(45^\circ\)</span> angle.
Let’s use our function to check that this is correct.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">theta</span> <span class="o">=</span> <span class="n">angle_between_vectors</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;angle between x and y: &#39;</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;pi/4: &#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>angle between x and y:  0.7853981633974484
pi/4:  0.7853981633974483
</pre></div>
</div>
</div>
</div>
<p>As expected, the answer is <span class="math notranslate nohighlight">\(\pi/4\)</span>.
Let’s see what happens when we rotate the vectors by some angle.
Recall that the matrix which rotates vectors by <span class="math notranslate nohighlight">\(\theta\)</span> degrees is given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\boldsymbol{R}_\theta = \begin{bmatrix}\cos(\theta) &amp; -\sin(\theta)\\ \sin(\theta) &amp; \cos(\theta)\end{bmatrix}
\end{split}\]</div>
<p>Let’s write a quick Python function to create this matrix.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">rotation</span><span class="p">(</span><span class="n">theta</span><span class="p">):</span>
    <span class="n">Rtheta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)],[</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)]])</span>
    <span class="k">return</span> <span class="n">Rtheta</span>
</pre></div>
</div>
</div>
</div>
<p>Now let’s try rotating <span class="math notranslate nohighlight">\(\boldsymbol{y}\)</span> by <span class="math notranslate nohighlight">\(90^\circ\)</span> (or <span class="math notranslate nohighlight">\(\pi/2\)</span> radians) and <span class="math notranslate nohighlight">\(\boldsymbol{x}\)</span> by <span class="math notranslate nohighlight">\(45^\circ\)</span> (or <span class="math notranslate nohighlight">\(\pi/4\)</span>) radians, and plot the newly rotated vectors.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R90</span> <span class="o">=</span> <span class="n">rotation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">R45</span> <span class="o">=</span> <span class="n">rotation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>

<span class="n">y_rotated</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">R90</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">x_rotated</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">R45</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="o">*</span><span class="n">origin</span><span class="p">,</span> <span class="o">*</span><span class="n">x_rotated</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;x rotated by pi/4&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="o">*</span><span class="n">origin</span><span class="p">,</span> <span class="o">*</span><span class="n">y_rotated</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;y rotated by pi/2&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/basicLA_4_dot-products-and-angles_9_0.png" src="../_images/basicLA_4_dot-products-and-angles_9_0.png" />
</div>
</div>
<p>The vectors appear to now by at a <span class="math notranslate nohighlight">\(90^\circ\)</span> angle (which is what we would expect), but we can also verify this using our <code class="docutils literal notranslate"><span class="pre">angle_between_vectors</span></code> function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;angle between x (rotated by pi/4) and y (rotated by pi/2): &#39;</span><span class="p">,</span> <span class="n">angle_between_vectors</span><span class="p">(</span><span class="n">x_rotated</span><span class="p">,</span> <span class="n">y_rotated</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>angle between x (rotated by pi/4) and y (rotated by pi/2):  1.5707963267948966
</pre></div>
</div>
</div>
</div>
<p>The answer is <span class="math notranslate nohighlight">\(\approx 1.5708\)</span>, which is just <span class="math notranslate nohighlight">\(\pi/2\)</span>.</p>
<p>Vectors which are at a <span class="math notranslate nohighlight">\(90^\circ\)</span> angle are special – they are called <em>orthogonal</em> (or <em>perpendicular</em>).</p>
</div>
<div class="section" id="a-gotcha">
<h3><span class="section-number">6.1.1.3. </span>A gotcha<a class="headerlink" href="#a-gotcha" title="Permalink to this headline">¶</a></h3>
<p>One point which is important to keep in mind when computing angles numerically is that we need to be careful when applying the <span class="math notranslate nohighlight">\(\arccos\)</span> function in practice. To meaningfully interpret the angle <span class="math notranslate nohighlight">\(\arccos \left(\frac{\boldsymbol{x}^\top \boldsymbol{y}}{\|\boldsymbol{x}\|_2 \|\boldsymbol{y}\|_2}\right)\)</span>, we need to have that <span class="math notranslate nohighlight">\(-1\leq \frac{\boldsymbol{x}^\top \boldsymbol{y}}{\|\boldsymbol{x}\|_2 \|\boldsymbol{y}\|_2} \leq 1\)</span>. This is always true mathematically; however, numerically we could run into situations where <span class="math notranslate nohighlight">\(\boldsymbol{x}\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{y}\)</span> are parallel, but when we compute <span class="math notranslate nohighlight">\(\frac{\boldsymbol{x}^\top \boldsymbol{y}}{\|\boldsymbol{x}\|_2 \|\boldsymbol{y}\|_2}\)</span> we obtain a number like <span class="math notranslate nohighlight">\(1.0000000000000002\)</span>. In this case, when we take the arccosine, we won’t get a meaningful answer (since it is only defined for values in <span class="math notranslate nohighlight">\([-1,1]\)</span>. Let’s see a simple example.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span> <span class="c1">#set seed for reproducibility</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="mf">1.2340124</span><span class="o">*</span><span class="n">a</span>

<span class="n">angle_between_vectors</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-1-4c22cc47b71a&gt;:7: RuntimeWarning: invalid value encountered in arccos
  theta = np.arccos(xty/(norm_x*norm_y))
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>nan
</pre></div>
</div>
</div>
</div>
<p>Here our function returns <code class="docutils literal notranslate"><span class="pre">nan</span></code>. We can check that the issue is numerical by computing <span class="math notranslate nohighlight">\(\frac{\boldsymbol{x}^\top \boldsymbol{y}}{\|\boldsymbol{x}\|_2 \|\boldsymbol{y}\|_2}\)</span> directly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0000000000000002
</pre></div>
</div>
</div>
</div>
<p>Indeed, we get a number which is very slightly larger than <span class="math notranslate nohighlight">\(1\)</span>. In cases like this, it might be reasonable to try and round the value <span class="math notranslate nohighlight">\(\frac{\boldsymbol{x}^\top \boldsymbol{y}}{\|\boldsymbol{x}\|_2 \|\boldsymbol{y}\|_2}\)</span>.</p>
</div>
</div>
<div class="section" id="orthogonal-vectors-bases-and-matrices">
<h2><span class="section-number">6.1.2. </span>Orthogonal vectors, bases, and matrices<a class="headerlink" href="#orthogonal-vectors-bases-and-matrices" title="Permalink to this headline">¶</a></h2>
<p>Let’s see what it means for two vectors to be orthogonal in terms of their dot product.
If the angle between <span class="math notranslate nohighlight">\(\boldsymbol{x}\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{y}\)</span> is <span class="math notranslate nohighlight">\(90^\circ\)</span> (or <span class="math notranslate nohighlight">\(\pi/2\)</span> radians), then</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align*}
&amp;\arccos \left(\frac{\boldsymbol{x}^\top \boldsymbol{y}}{\|\boldsymbol{x}\|_2 \|\boldsymbol{y}\|_2}\right) = \pi/2 \\\iff &amp;\frac{\boldsymbol{x}^\top \boldsymbol{y}}{\|\boldsymbol{x}\|_2 \|\boldsymbol{y}\|_2} = \cos(\pi/2) = 0\\ \iff &amp; \boldsymbol{x}^\top \boldsymbol{y}= 0
\end{align*}
\end{split}\]</div>
<p>Therefore, two vectors <span class="math notranslate nohighlight">\(\boldsymbol{x}\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{y}\)</span> are <em>orthogonal</em> if and only if their dot product is zero.
Orthogonal vectors play an important role in linear algebra.
In particular, we can define orthogonality between two vectors, between a vector and a subspace, and between two subspaces.</p>
<div class="section" id="orthogonality-between-two-subspaces">
<h3><span class="section-number">6.1.2.1. </span>Orthogonality between two subspaces<a class="headerlink" href="#orthogonality-between-two-subspaces" title="Permalink to this headline">¶</a></h3>
<p>The notion of orthogonality is also easily extended to the span of two sets of vectors. For example, consider matrices <span class="math notranslate nohighlight">\(\boldsymbol{A} \in \mathbb{R}^{n\times k}\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{B} \in \mathbb{R}^{n\times p}\)</span>, and let <span class="math notranslate nohighlight">\(\boldsymbol{a}_{:1},\dots,\boldsymbol{a}_{:k} \in \mathbb{R}^n\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{b}_{:1},\dots, \boldsymbol{b}_{:p}\in \mathbb{R}^n\)</span> be their columns. Given these matrices, we can define the following special subspaces of <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span>: <span class="math notranslate nohighlight">\(V_\boldsymbol{A} = \text{span}(\boldsymbol{a}_{:1},\dots,\boldsymbol{a}_{:k})\)</span> and <span class="math notranslate nohighlight">\(V_\boldsymbol{B} = \text{span}(\boldsymbol{b}_{:1},\dots,\boldsymbol{b}_{:p})\)</span>. <span class="math notranslate nohighlight">\(V_\boldsymbol{A}\)</span> and <span class="math notranslate nohighlight">\(V_\boldsymbol{B}\)</span> are called the <em>column spaces</em> of <span class="math notranslate nohighlight">\(\boldsymbol{A}\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{B}\)</span>, respectively. Then we say that the subspaces <span class="math notranslate nohighlight">\(V_\boldsymbol{A}\)</span> and <span class="math notranslate nohighlight">\(V_\boldsymbol{B}\)</span> are <em>orthogonal</em> if and only if <span class="math notranslate nohighlight">\(\boldsymbol{a}_{:i}^\top \boldsymbol{b}_{:j} = 0\)</span> for all <span class="math notranslate nohighlight">\(i=1,\dots,k\)</span> and <span class="math notranslate nohighlight">\(j=1,\dots,p\)</span>. Since we know that the the <span class="math notranslate nohighlight">\((i,j)^{th}\)</span> element of <span class="math notranslate nohighlight">\(\boldsymbol{A}^\top \boldsymbol{B}\)</span> is exactly <span class="math notranslate nohighlight">\(\boldsymbol{a}_{:i}^\top \boldsymbol{b}_{:j}\)</span>, this is equivalent to saying that <span class="math notranslate nohighlight">\(\boldsymbol{A}^\top \boldsymbol{B} = \boldsymbol{0}_{p\times p}\)</span> where <span class="math notranslate nohighlight">\(\boldsymbol{0}_{k\times p}\)</span> is the <span class="math notranslate nohighlight">\(k\times p\)</span> matrix of all zeros.</p>
<p>As a special case of this, we have that a vector <span class="math notranslate nohighlight">\(\boldsymbol{x} = \begin{bmatrix}x_1\\ \vdots \\ x_n\end{bmatrix}\)</span> is orthogonal to the column space of <span class="math notranslate nohighlight">\(\boldsymbol{A}\)</span> if <span class="math notranslate nohighlight">\(\boldsymbol{Ax}=0\)</span>. In this case, we say that <span class="math notranslate nohighlight">\(\boldsymbol{x}\)</span> is in the <em>null space</em> of <span class="math notranslate nohighlight">\(\boldsymbol{A}\)</span>.  We also may use the notation <span class="math notranslate nohighlight">\(\text{null}(\boldsymbol{A})\)</span> to denote the set of vectors <span class="math notranslate nohighlight">\(\boldsymbol{x}\)</span> such that <span class="math notranslate nohighlight">\(\boldsymbol{Ax}= 0\)</span>. This set is also a subspace of <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span>.</p>
<p>To understand this visually, let’s consider the matrix <span class="math notranslate nohighlight">\(\boldsymbol{A}\)</span> given below</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\boldsymbol{A} = \begin{bmatrix}1 &amp; 0\\ 2&amp; 3\\ 3&amp;2\end{bmatrix}
\end{split}\]</div>
<p>Let’s define the columns as vectors <span class="math notranslate nohighlight">\(\boldsymbol{a}_{:1} = \begin{bmatrix}1\\2\\3\end{bmatrix}\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{a}_{:2} = \begin{bmatrix}0\\3\\2\end{bmatrix}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">a2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>The subspace <span class="math notranslate nohighlight">\(V_\boldsymbol{A} = \text{span}(\boldsymbol{a}_{:1},\boldsymbol{a}_{:2})\)</span> is a plane in <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span>, which we can visualize with the code below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">)</span>
<span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">cp</span>

<span class="n">origin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">cp</span><span class="p">,</span> <span class="n">origin</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="o">*</span><span class="n">origin</span><span class="p">,</span><span class="o">*</span><span class="n">a1</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">arrow_length_ratio</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;a1&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="o">*</span><span class="n">origin</span><span class="p">,</span><span class="o">*</span><span class="n">a2</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">arrow_length_ratio</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;a2&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">q</span> <span class="o">=</span> <span class="p">(</span><span class="n">d</span> <span class="o">-</span> <span class="n">a</span> <span class="o">*</span> <span class="n">xx</span> <span class="o">-</span> <span class="n">b</span> <span class="o">*</span> <span class="n">yy</span><span class="p">)</span> <span class="o">/</span> <span class="n">c</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">120</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-10-971b28b9a8ec&gt;:9: MatplotlibDeprecationWarning: Calling gca() with keyword arguments was deprecated in Matplotlib 3.4. Starting two minor releases later, gca() will take no keyword arguments. The gca() function should only be used to get the current axes, or if no axes exist, create new axes with default keyword arguments. To create a new axes with non-default arguments, use plt.axes() or plt.subplot().
  ax = fig.gca(projection=&#39;3d&#39;)
</pre></div>
</div>
<img alt="../_images/basicLA_4_dot-products-and-angles_19_1.png" src="../_images/basicLA_4_dot-products-and-angles_19_1.png" />
</div>
</div>
<p>Now let’s find a vector that’s orthogonal to the <em>subspace</em> <span class="math notranslate nohighlight">\(V_\boldsymbol{A}\)</span>. Such a vector <span class="math notranslate nohighlight">\(\boldsymbol{x} = \begin{bmatrix}x_1 \\ x_2 \\ x_3\end{bmatrix}\)</span> satisfies</p>
<div class="math notranslate nohighlight">
\[
0 = \boldsymbol{a}_{:1}^\top \boldsymbol{x} = x_1 + 2x_2 + 3x_3\;\;\; \text{ and }\;\;\; 0 = \boldsymbol{a}_{:2}^\top x = 3x_2 + 2x_3
\]</div>
<p>With some algebra, it is easy to verify that any vector <span class="math notranslate nohighlight">\(\boldsymbol{x}\)</span> of the form <span class="math notranslate nohighlight">\(\boldsymbol{x} = \begin{bmatrix}\frac{5}{2}\alpha \\ \alpha \\ -\frac{3}{2}\alpha\end{bmatrix}\)</span> will satisfy these conditions. Let’s see an example with <span class="math notranslate nohighlight">\(\alpha = -2\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">5</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">alpha</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="o">*</span><span class="n">alpha</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Now let’s plot <span class="math notranslate nohighlight">\(\boldsymbol{x}\)</span> and see that it is in fact orthogonal to the plane <span class="math notranslate nohighlight">\(V_\boldsymbol{A}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">)</span>
<span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">cp</span>

<span class="n">origin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">cp</span><span class="p">,</span> <span class="n">origin</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="o">*</span><span class="n">origin</span><span class="p">,</span><span class="o">*</span><span class="n">a1</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">arrow_length_ratio</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;a1&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="o">*</span><span class="n">origin</span><span class="p">,</span><span class="o">*</span><span class="n">a2</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">arrow_length_ratio</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;a2&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="o">*</span><span class="n">origin</span><span class="p">,</span><span class="o">*</span><span class="n">x</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">arrow_length_ratio</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">xx</span><span class="p">,</span> <span class="n">yy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">q</span> <span class="o">=</span> <span class="p">(</span><span class="n">d</span> <span class="o">-</span> <span class="n">a</span> <span class="o">*</span> <span class="n">xx</span> <span class="o">-</span> <span class="n">b</span> <span class="o">*</span> <span class="n">yy</span><span class="p">)</span> <span class="o">/</span> <span class="n">c</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">yy</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">120</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-12-3ad0f67e00da&gt;:9: MatplotlibDeprecationWarning: Calling gca() with keyword arguments was deprecated in Matplotlib 3.4. Starting two minor releases later, gca() will take no keyword arguments. The gca() function should only be used to get the current axes, or if no axes exist, create new axes with default keyword arguments. To create a new axes with non-default arguments, use plt.axes() or plt.subplot().
  ax = fig.gca(projection=&#39;3d&#39;)
</pre></div>
</div>
<img alt="../_images/basicLA_4_dot-products-and-angles_23_1.png" src="../_images/basicLA_4_dot-products-and-angles_23_1.png" />
</div>
</div>
<p>As we can see, not only is the vector <span class="math notranslate nohighlight">\(x\)</span> orthogonal to both the vectors <span class="math notranslate nohighlight">\(\boldsymbol{a}_{:1}\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{a}_{:2}\)</span>, but it is in fact orthogonal to the entire subspace <span class="math notranslate nohighlight">\(V_\boldsymbol{A}\)</span>.</p>
</div>
<div class="section" id="orthogonal-and-orthonormal-sets-and-bases">
<h3><span class="section-number">6.1.2.2. </span>Orthogonal and orthonormal sets and bases<a class="headerlink" href="#orthogonal-and-orthonormal-sets-and-bases" title="Permalink to this headline">¶</a></h3>
<p>Before defining what an orthogonal basis is, we first cover what it means for a set of vectors to be orthogonal.
A set <span class="math notranslate nohighlight">\(V = \{\boldsymbol{v}_1,\dots,\boldsymbol{v}_k\}\)</span> of vectors <span class="math notranslate nohighlight">\(\boldsymbol{v}_1,\dots,\boldsymbol{v}_k \in \mathbb{R}^n\)</span> is called an <em>orthogonal set</em> if <span class="math notranslate nohighlight">\(\boldsymbol{v}_i^\top \boldsymbol{v}_j = 0\)</span> for any <span class="math notranslate nohighlight">\(i\neq j\)</span>.
Since a basis is just a linearly indepedent set of vectors which spans a vector space, an <em>orthogonal basis</em> is simply a basis which is also orthogonal.</p>
<p>For example, the standard basis in <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span> is orthogonal.
Here the standard basis is the set <span class="math notranslate nohighlight">\(E = \{\boldsymbol{e}_1,\dots, \boldsymbol{e}_n\}\)</span> where</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\boldsymbol{e}_i = \begin{bmatrix}0\\ \vdots \\1\\ \vdots \\ 0\end{bmatrix}
\end{split}\]</div>
<p>i.e., it is <span class="math notranslate nohighlight">\(1\)</span> in the <span class="math notranslate nohighlight">\(i^{th}\)</span> coordinate and <span class="math notranslate nohighlight">\(0\)</span> elsewhere.
Then since for <span class="math notranslate nohighlight">\(i\neq j\)</span>, the vectors <span class="math notranslate nohighlight">\(\boldsymbol{e}_i\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{e}_j\)</span> don’t have any non-zero entries in common, it is easy to see that <span class="math notranslate nohighlight">\(\boldsymbol{e}_i^\top \boldsymbol{e}_j = 0\)</span>.
Hence the set <span class="math notranslate nohighlight">\(E\)</span> is an orthogonal set, and since we know it is a basis, it is also an orthogonal basis!</p>
<p>It turns out that requiring a set to be orthogonal an linearly independent is superfluous: every orthogonal set is automatically linearly independent (though the converse is not true).
We won’t prove this here, but it is a good exercise to try on your own.
Therefore, an orthogonal basis for <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span> is any orthogonal set of vectors which spans <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span>.
While the standard basis is an easy example, it is not the only example.
For instance, any rotation of the standard basis is also an orthogonal basis.</p>
<p>For example, let’s start with the standard basis in <span class="math notranslate nohighlight">\(\mathbb{R}^2\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\boldsymbol{e}_1 = \begin{bmatrix}1\\ 0\end{bmatrix},\;\;\; \boldsymbol{e}_2 = \begin{bmatrix}0\\ 1\end{bmatrix}
\end{split}\]</div>
<p>Let’s define these in Python.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">e1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">e2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Now, let’s try rotating these vectors by <span class="math notranslate nohighlight">\(45^\circ\)</span>.
To do this, we can use the rotation matrix that we defined in the previous section.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">R45</span> <span class="o">=</span> <span class="n">rotation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>

<span class="n">v1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">R45</span><span class="p">,</span> <span class="n">e1</span><span class="p">)</span>
<span class="n">v2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">R45</span><span class="p">,</span> <span class="n">e2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;v1 = &#39;</span><span class="p">,</span> <span class="n">v1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;v2 = &#39;</span><span class="p">,</span> <span class="n">v2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>v1 =  [0.70710678 0.70710678]
v2 =  [-0.70710678  0.70710678]
</pre></div>
</div>
</div>
</div>
<p>This gives the vectors</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\boldsymbol{v}_1 = \begin{bmatrix}1/\sqrt{2}\\ 1/\sqrt{2}\end{bmatrix},\;\;\; \boldsymbol{v}_2 = \begin{bmatrix}-1/\sqrt{2}\\ 1/\sqrt{2}\end{bmatrix}
\end{split}\]</div>
<p>Let’s check that these vectors are still orthogonal, but in two different ways.
First, we can use the <code class="docutils literal notranslate"><span class="pre">angle_between_vectors</span></code> function to check that the angle between <span class="math notranslate nohighlight">\(\boldsymbol{v}_1\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{v}_2\)</span> is indeed <span class="math notranslate nohighlight">\(90^\circ\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">angle_between_vectors</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span><span class="n">v2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.5707963267948966
</pre></div>
</div>
</div>
</div>
<p>As expected, we get <span class="math notranslate nohighlight">\(\pi/2\)</span> back.
On the other hand, we can also check that <span class="math notranslate nohighlight">\(v_1^\top v_2 = 0\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span><span class="n">v2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0
</pre></div>
</div>
</div>
</div>
<p>The set <span class="math notranslate nohighlight">\(\{\boldsymbol{v}_1,\boldsymbol{v}_2\}\)</span> is not only an orthogonal set, but it is in fact an <em>orthonormal set</em>.
This means that the vectors are orthogonal, but are also unit vectors.
Given an orthogonal set, it is easy to construct an othonormal set by simply dividing each vector in the set by its norm.
If <span class="math notranslate nohighlight">\(V = \{\boldsymbol{v}_1,\dots, \boldsymbol{v}_k\}\)</span> is an orthonormal set, then we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\boldsymbol{v}_i^\top \boldsymbol{v}_j = \begin{cases}1 &amp; \text{if } i=j\\ 0 &amp; \text{if } i\neq j\end{cases}
\end{split}\]</div>
</div>
<div class="section" id="orthogonal-matrices">
<h3><span class="section-number">6.1.2.3. </span>Orthogonal matrices<a class="headerlink" href="#orthogonal-matrices" title="Permalink to this headline">¶</a></h3>
<p>Suppose we have an orthonormal set of vectors <span class="math notranslate nohighlight">\(V = \{\boldsymbol{v}_1,\dots,\boldsymbol{v}_k\}\)</span>, where <span class="math notranslate nohighlight">\(\boldsymbol{v}_i \in \mathbb{R}^n\)</span>.
We can stack these vectors into a <span class="math notranslate nohighlight">\(n\times k\)</span> matrix <span class="math notranslate nohighlight">\(\boldsymbol{Q}\)</span>, with <span class="math notranslate nohighlight">\(\boldsymbol{v}_{i}\)</span> being the <span class="math notranslate nohighlight">\(i^{th}\)</span> column of <span class="math notranslate nohighlight">\(\boldsymbol{Q}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\boldsymbol{Q} = \begin{bmatrix}|&amp;|&amp;&amp;|\\ \boldsymbol{v}_1 &amp; \boldsymbol{v}_2 &amp; \cdots &amp; \boldsymbol{v}_k\\ |&amp;|&amp;&amp;|\end{bmatrix}
\end{split}\]</div>
<p>Let’s see what happens what we compute the matrix <span class="math notranslate nohighlight">\(\boldsymbol{Q}^\top \boldsymbol{Q}\)</span>.
Since <span class="math notranslate nohighlight">\(\boldsymbol{Q}\)</span> is <span class="math notranslate nohighlight">\(n\times k\)</span>, <span class="math notranslate nohighlight">\(\boldsymbol{Q}^\top \boldsymbol{Q}\)</span> is a <span class="math notranslate nohighlight">\(k\times k\)</span>.
As we mentioned earlier in this section, the <span class="math notranslate nohighlight">\((i,j)^{th}\)</span> entry of <span class="math notranslate nohighlight">\(\boldsymbol{Q}^\top \boldsymbol{Q}\)</span> is just <span class="math notranslate nohighlight">\(\boldsymbol{v}_i^\top \boldsymbol{v}_j\)</span>.
Therefore, we have the following description of the entries of <span class="math notranslate nohighlight">\(\boldsymbol{Q}^\top \boldsymbol{Q}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
[\boldsymbol{Q}^\top \boldsymbol{Q}]_{ij} = \boldsymbol{v}_i^\top \boldsymbol{v}_j = \begin{cases}1 &amp; \text{if } i=j\\ 0 &amp; \text{if } i\neq j\end{cases}
\end{split}\]</div>
<p>Therefore, the diagonal entries of <span class="math notranslate nohighlight">\(\boldsymbol{Q}^\top \boldsymbol{Q}\)</span> are <span class="math notranslate nohighlight">\(1\)</span> and the off-diagonal entries are 0.
Said another way, <span class="math notranslate nohighlight">\(\boldsymbol{Q}^\top \boldsymbol{Q} = \boldsymbol{I}\)</span> – i.e., it is the identity matrix on <span class="math notranslate nohighlight">\(\mathbb{R}^k\)</span>.
Any matrix <span class="math notranslate nohighlight">\(\boldsymbol{Q}\)</span> which satisfies <span class="math notranslate nohighlight">\(\boldsymbol{Q}^\top \boldsymbol{Q} = \boldsymbol{I}\)</span> is called an <em>orthogonal matrix</em>.
Equivalently, an orthogonal matrix is a matrix whose columns form an orthonormal set.</p>
<p><strong>Remark:</strong> One point that often causes confusion is that an orthogonal matrix <span class="math notranslate nohighlight">\(\boldsymbol{Q}\)</span> doesn’t just have <em>orthogonal</em> columns, but rather <em>orthonormal</em> columns.
Perhaps it would make more sense to call such a matrix <span class="math notranslate nohighlight">\(\boldsymbol{Q}\)</span> an orthonormal matrix, but unfortunately this terminology is now standard, and so it is important to remember this distinction.</p>
<p>Let’s see a few examples of orthogonal matrices in Python.
We can start with our set <span class="math notranslate nohighlight">\(\{\boldsymbol{v}_1,\boldsymbol{v}_2\}\)</span> that we defined above, from rotating the standard basis by <span class="math notranslate nohighlight">\(45^\circ\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">v1</span><span class="p">,</span><span class="n">v2</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Q</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0.70710678, -0.70710678],
       [ 0.70710678,  0.70710678]])
</pre></div>
</div>
</div>
</div>
<p>Let’s check that <span class="math notranslate nohighlight">\(\boldsymbol{Q}^\top \boldsymbol{Q} = I\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1., 0.],
       [0., 1.]])
</pre></div>
</div>
</div>
</div>
<p>Here we round to 8 decimals to avoid issues of numerical precision (though in practice you may want to be careful when doing this).
In fact, since the matrix <span class="math notranslate nohighlight">\(\boldsymbol{Q}\)</span> is square in this case, we observe that <span class="math notranslate nohighlight">\(\boldsymbol{Q}^{-1} = \boldsymbol{Q}^\top\)</span>.
This relationship is true for any square orthogonal matrix.</p>
<p>We can also look at a bigger example.
For now, we won’t explain how the below method works; we will cover this in the next section of the workbook.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<span class="n">Q</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">qr</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">Q</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-0.29879562, -0.08953108,  0.28310143, -0.17812753,  0.1817313 ],
       [-0.1911694 , -0.5275274 ,  0.25809256,  0.26005771,  0.05751883],
       [ 0.32453527, -0.19070235, -0.27823328,  0.23202825,  0.44990415],
       [-0.28069118, -0.29076626, -0.55215378, -0.01522534,  0.13783841],
       [-0.1125048 ,  0.53952547, -0.19709356,  0.12622255, -0.39309112],
       [-0.07642162, -0.02851513,  0.14712695, -0.4140561 , -0.17919942],
       [-0.35446295,  0.2289251 , -0.04288013,  0.71914892,  0.05203953],
       [-0.00520691, -0.49825669, -0.14498771,  0.15888964, -0.73422497],
       [-0.56956093,  0.00740262,  0.35069433,  0.00974239,  0.07492084],
       [ 0.47063404, -0.01282762,  0.51440781,  0.34158609, -0.09061755]])
</pre></div>
</div>
</div>
</div>
<p>Let’s check that the <span class="math notranslate nohighlight">\(10\times 5\)</span> matrix <span class="math notranslate nohighlight">\(\boldsymbol{Q}\)</span> is in fact orthogonal, by checking that <span class="math notranslate nohighlight">\(\boldsymbol{Q}^\top \boldsymbol{Q} = \boldsymbol{I}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1., -0., -0.,  0., -0.],
       [-0.,  1.,  0.,  0.,  0.],
       [-0.,  0.,  1., -0., -0.],
       [ 0.,  0., -0.,  1., -0.],
       [-0.,  0., -0., -0.,  1.]])
</pre></div>
</div>
</div>
</div>
<p>Indeed it is.</p>
<p>In the above code, we used something called a QR decomposition to generate the othogonal matrix <span class="math notranslate nohighlight">\(\boldsymbol{Q}\)</span>.
This is a generic method which we can use to find an orthogonal set from any given set of vectors in <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span>.
This is one of the most important decompositions in linear algebra, and we will discuss it in much more detail in the next sections of the workbook.</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./content"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="basicLA_4_chheader.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">6. </span>Geometry: angles, orthogonality, and projections</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="basicLA_4_QR.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">6.2. </span>Gram–Schmidt and the QR Decomposition</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Michael W. Mahoney, N. Benjamin Erichson and Ryan Theisen<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>
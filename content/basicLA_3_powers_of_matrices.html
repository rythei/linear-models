
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>4.3. Taking Powers of Matrices &#8212; Linear Algebra for Data Workbook</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="5. Matrices as transformations" href="basicLA_3B_chheader.html" />
    <link rel="prev" title="4.2. Deconstructing Matrix Multiplication" href="basicLA_3_deconstructing.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Linear Algebra for Data Workbook</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../overview.html">
   Welcome to Stat 89A
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Background
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="python_chheader.html">
   1. Python 101
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="python_basics.html">
     1.1. The Basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="python_numpy.html">
     1.2. Introduction to NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="python_plotting.html">
     1.3. MatPlotLib
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Basic Linear Algebra
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="basicLA_1_chheader.html">
   2. Matrices, vectors, and
   <span class="math notranslate nohighlight">
    \(\mathbb{R}^n\)
   </span>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="basicLA_1_introduction-to-norms.html">
     2.1. Introduction to Norms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="basicLA_1_norms-integration-monte-carlo.html">
     2.2. An application: approximating integrals with norms and Monte Carlo integration
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="basicLA_1_lp-balls.html">
     2.3.
     <span class="math notranslate nohighlight">
      \(\ell_p\)
     </span>
     Balls
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="basicLA_1_classification-with-norms.html">
     2.4. An application: classifying data points using norms
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="basicLA_2_chheader.html">
   3. Basics of vectors and vector spaces
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="basicLA_2A_vectorspaces.html">
     3.1. Vectors and vector spaces
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="basicLA_3_chheader.html">
   4. Basics of matrices
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="basicLA_3_matrices-and-matrix-operations.html">
     4.1. Matrices and matrix operations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="basicLA_3_deconstructing.html">
     4.2. Deconstructing Matrix Multiplication
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     4.3. Taking Powers of Matrices
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="basicLA_3B_chheader.html">
   5. Matrices as transformations
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="basicLA_3_linear_examples_new.html">
     5.1. Linear and Nonlinear Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="basicLA_3_matrices_and_linear_functions.html">
     5.2. Matrices and Linear Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="basicLA_3_injective-and-surjective-functions.html">
     5.3. Injective, surjective and invertible functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="basicLA_3_inverses.html">
     5.4. Left Inverses, Right Inverses, and Inverses
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="basicLA_3_changing_basis.html">
     5.5. Changing Basis
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="basicLA_4_chheader.html">
   6. Geometry: angles, orthogonality, and projections
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="basicLA_4_dot-products-and-angles.html">
     6.1. Dot products, angles, and orthogonality
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="basicLA_4_QR.html">
     6.2. Gram–Schmidt and the QR Decomposition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="basicLA_4_QR_linear_systems.html">
     6.3. Solving linear systems with the QR decomposition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="basicLA_4_projections.html">
     6.4. Projections
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  The EVD, SVD and applications
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="eigenstuff_chheader.html">
   7. Eigenthings
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="eigenstuff_quadratic-forms.html">
     7.1. Quadratic forms
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="eigenstuff_eigenthings.html">
     7.2. Eigenvalues and eigenvectors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="eigenstuff_eigenthings-special-matrices.html">
     7.3. The Eigenvalue decomposition for special types of matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="eigenstuff_qr-algorithm.html">
     7.4. The QR algorithm for finding eigenvalues and eigenvectors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="eigenstuff_SVD.html">
     7.5. The Singular Value Decomposition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="eigenstuff_low-rank-approximation.html">
     7.6. Low-rank approximation using the SVD
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="applications_chheader.html">
   8. Applications
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="applications_PCA.html">
     8.1. Principal Component Analysis (PCA)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="applications_spectral-clustering.html">
     8.2. Sprectral Clustering
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="applications_least-squares.html">
     8.3. Least Squares
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="applications_double-descent.html">
     8.4. The “double descent” phenomenon
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="../_sources/content/basicLA_3_powers_of_matrices.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/content/basicLA_3_powers_of_matrices.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/erichson/LinearAlgebra/master?urlpath=tree/content/basicLA_3_powers_of_matrices.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#powers-of-a-diagonal-matrix">
   4.3.1. Powers of a diagonal matrix
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#powers-of-a-diagonal-matrix-as-k-to-infty">
     4.3.1.1. Powers of a diagonal matrix as
     <span class="math notranslate nohighlight">
      \(k\to \infty\)
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#powers-of-a-genenal-symmetric-matrix">
   4.3.2. Powers of a genenal (symmetric) matrix
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#powers-of-a-genenal-symmetric-matrix-as-k-to-infty">
     4.3.2.1. Powers of a genenal (symmetric) matrix as
     <span class="math notranslate nohighlight">
      \(k\to \infty\)
     </span>
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Taking Powers of Matrices</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#powers-of-a-diagonal-matrix">
   4.3.1. Powers of a diagonal matrix
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#powers-of-a-diagonal-matrix-as-k-to-infty">
     4.3.1.1. Powers of a diagonal matrix as
     <span class="math notranslate nohighlight">
      \(k\to \infty\)
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#powers-of-a-genenal-symmetric-matrix">
   4.3.2. Powers of a genenal (symmetric) matrix
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#powers-of-a-genenal-symmetric-matrix-as-k-to-infty">
     4.3.2.1. Powers of a genenal (symmetric) matrix as
     <span class="math notranslate nohighlight">
      \(k\to \infty\)
     </span>
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="taking-powers-of-matrices">
<h1><span class="section-number">4.3. </span>Taking Powers of Matrices<a class="headerlink" href="#taking-powers-of-matrices" title="Permalink to this headline">¶</a></h1>
<p>Taking powers of matrices refers to multiplying a matrix by itself multiple times.</p>
<p>Given an <span class="math notranslate nohighlight">\(n \times n\)</span> matrix <span class="math notranslate nohighlight">\(\boldsymbol{A}\)</span>, we can multiply it by itself to get <span class="math notranslate nohighlight">\(\boldsymbol{AA}\)</span>, and this can be denoted <span class="math notranslate nohighlight">\(\boldsymbol{A}^2\)</span>.
Then, since <span class="math notranslate nohighlight">\(\boldsymbol{A}^2\)</span> is an <span class="math notranslate nohighlight">\(n \times n\)</span> matrix, we can multiply it to get <span class="math notranslate nohighlight">\(\boldsymbol{A}^3\)</span>, and so on</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{A}^k = \boldsymbol{A} \cdots \boldsymbol{A}  ,
\]</div>
<p>where there are <span class="math notranslate nohighlight">\(k\)</span> copies of <span class="math notranslate nohighlight">\(\boldsymbol{A}\)</span> in this product.
Taking powers of matrices is very common.
Here, we will explore some of the properties of this operation.</p>
<p>There are two (related) ways to view this.</p>
<ul class="simple">
<li><p>First, we can simply multiply <span class="math notranslate nohighlight">\(\boldsymbol{A}\)</span> by itself multiple times and see what happens.</p></li>
<li><p>Second, we can think of <span class="math notranslate nohighlight">\(\boldsymbol{A}\)</span> as multiplying a vector <span class="math notranslate nohighlight">\(\boldsymbol{x}\)</span>, as in <span class="math notranslate nohighlight">\(\boldsymbol{Ax}\)</span>, and see what happens if we do this multiple times, i.e., what is <span class="math notranslate nohighlight">\(\boldsymbol{A}(\boldsymbol{A}(\cdots(\boldsymbol{A}(\boldsymbol{x}))))\)</span>.</p></li>
</ul>
<p>We are interested in both of these views.</p>
<div class="section" id="powers-of-a-diagonal-matrix">
<h2><span class="section-number">4.3.1. </span>Powers of a diagonal matrix<a class="headerlink" href="#powers-of-a-diagonal-matrix" title="Permalink to this headline">¶</a></h2>
<p>Let’s start by considering powers of a diagonal matrix.</p>
<p>Consider a diagonal matrix <span class="math notranslate nohighlight">\(A\)</span> of the form</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\boldsymbol{A} = \begin{pmatrix}a_1 &amp; 0 &amp;\cdots &amp;0\\
									 0   &amp; a_2 &amp; \cdots &amp;0\\
                   \vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
                   0 &amp;\cdots &amp;0&amp;a_n
		\end{pmatrix}
\end{split}\]</div>
<p>If we take the second power of this matrix, i.e. <span class="math notranslate nohighlight">\(\boldsymbol{A}^2 = \boldsymbol{AA}\)</span>, the resulting matrix is</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\boldsymbol{A}^2 = \boldsymbol{AA} = \begin{pmatrix}a_1 &amp; 0 &amp;\cdots &amp;0\\
									 0   &amp; a_2 &amp; \cdots &amp;0\\
                   \vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
                   0 &amp;\cdots &amp;0&amp;a_n
		\end{pmatrix}\begin{pmatrix}a_1 &amp; 0 &amp;\cdots &amp;0\\
									 0   &amp; a_2 &amp; \cdots &amp;0\\
                   \vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
                   0 &amp;\cdots &amp;0&amp;a_n
		\end{pmatrix} = \begin{pmatrix}a_1^2 &amp; 0 &amp;\cdots &amp;0\\
									 0   &amp; a_2^2 &amp; \cdots &amp;0\\
                   \vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
                   0 &amp;\cdots &amp;0&amp;a_n^2
		\end{pmatrix}
\end{split}\]</div>
<p>Hence we see that the second power of a diagonal matrix is obtained by simply squaring each entry.
More generally, the <span class="math notranslate nohighlight">\(k^{th}\)</span> power of a diagonal matrix can be seen to be</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\boldsymbol{A}^k = \begin{pmatrix}a_1^k &amp; 0 &amp;\cdots &amp;0\\
									 0   &amp; a_2^k &amp; \cdots &amp;0\\
                   \vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
                   0 &amp;\cdots &amp;0&amp;a_n^k
		\end{pmatrix}
\end{split}\]</div>
<p>Let’s verify this in Python.
First, we define a diagonal matrix <span class="math notranslate nohighlight">\(\boldsymbol{A}\)</span> using the <code class="docutils literal notranslate"><span class="pre">np.diag</span></code> function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">])</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1,  0,  0,  0,  0,  0,  0,  0,  0,  0],
       [ 0,  2,  0,  0,  0,  0,  0,  0,  0,  0],
       [ 0,  0,  3,  0,  0,  0,  0,  0,  0,  0],
       [ 0,  0,  0,  4,  0,  0,  0,  0,  0,  0],
       [ 0,  0,  0,  0,  5,  0,  0,  0,  0,  0],
       [ 0,  0,  0,  0,  0,  6,  0,  0,  0,  0],
       [ 0,  0,  0,  0,  0,  0,  7,  0,  0,  0],
       [ 0,  0,  0,  0,  0,  0,  0,  8,  0,  0],
       [ 0,  0,  0,  0,  0,  0,  0,  0,  9,  0],
       [ 0,  0,  0,  0,  0,  0,  0,  0,  0, 10]])
</pre></div>
</div>
</div>
</div>
<p>Before practicing taking powers of this matrix, let’s take a moment to review how we can take powers in Python more generally.
We can find the <span class="math notranslate nohighlight">\(k^{th}\)</span> power of a scalar <span class="math notranslate nohighlight">\(x\)</span> in Python by using the <code class="docutils literal notranslate"><span class="pre">**</span></code> operation. For example,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x^2 = &#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x^3 = &#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;x^4 = &#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x^2 =  4
x^3 =  8
x^4 =  16
</pre></div>
</div>
</div>
</div>
<p>The same operation can be used to take the <em>element-wise</em> power of a numpy array.
For example,</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="n">x</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 1,  4,  9, 16, 25])
</pre></div>
</div>
</div>
</div>
<p>This returns the array <code class="docutils literal notranslate"><span class="pre">[1,4,9,16,25]</span></code>, which are the squares of each of the entries of <code class="docutils literal notranslate"><span class="pre">[1,2,3,4,5]</span></code>.
The same applies to 2-d arrays, i.e., matrices.
In this case, we get the <em>element-wise</em> power of the matrix.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[  1,   0,   0,   0,   0,   0,   0,   0,   0,   0],
       [  0,   4,   0,   0,   0,   0,   0,   0,   0,   0],
       [  0,   0,   9,   0,   0,   0,   0,   0,   0,   0],
       [  0,   0,   0,  16,   0,   0,   0,   0,   0,   0],
       [  0,   0,   0,   0,  25,   0,   0,   0,   0,   0],
       [  0,   0,   0,   0,   0,  36,   0,   0,   0,   0],
       [  0,   0,   0,   0,   0,   0,  49,   0,   0,   0],
       [  0,   0,   0,   0,   0,   0,   0,  64,   0,   0],
       [  0,   0,   0,   0,   0,   0,   0,   0,  81,   0],
       [  0,   0,   0,   0,   0,   0,   0,   0,   0, 100]])
</pre></div>
</div>
</div>
</div>
<p>As we saw above, for diagonal matrices, this is the same as the second power of the matrix.
Let’s verify this.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">AA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">AA</span><span class="p">,</span> <span class="n">A</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>This is a very special property of diagonal matrices.
In general, the <span class="math notranslate nohighlight">\(k^{th}\)</span> power of a matrix <span class="math notranslate nohighlight">\(\boldsymbol{A}\)</span> will not be the same as taking the <span class="math notranslate nohighlight">\(k^{th}\)</span> power of each entry of <span class="math notranslate nohighlight">\(\boldsymbol{A}\)</span>, as we will see later on.</p>
<div class="section" id="powers-of-a-diagonal-matrix-as-k-to-infty">
<h3><span class="section-number">4.3.1.1. </span>Powers of a diagonal matrix as <span class="math notranslate nohighlight">\(k\to \infty\)</span><a class="headerlink" href="#powers-of-a-diagonal-matrix-as-k-to-infty" title="Permalink to this headline">¶</a></h3>
<p>A natural question to ask when taking power of a matrix is what happens to the matrix <span class="math notranslate nohighlight">\(\boldsymbol{A}^k\)</span> when we let <span class="math notranslate nohighlight">\(k\)</span> get large.
Does the matrix <span class="math notranslate nohighlight">\(\boldsymbol{A}^k\)</span> converge to a finite matrix <span class="math notranslate nohighlight">\(\boldsymbol{A}_\infty\)</span>?
Or do the entries diverge?</p>
<p>In the case of a diagonal matrix <span class="math notranslate nohighlight">\(\boldsymbol{A}\)</span>, this question is easy to answer, since we know that <span class="math notranslate nohighlight">\(\boldsymbol{A}^k\)</span> corresponds to taking the <span class="math notranslate nohighlight">\(k^{th}\)</span> power of each of the diagonal entries of <span class="math notranslate nohighlight">\(\boldsymbol{A}\)</span>.
Thus, our question can be answered by asking what happens to the scalar <span class="math notranslate nohighlight">\(x^k\)</span> as <span class="math notranslate nohighlight">\(k\to\infty\)</span>.
Indeed, we know the following are true:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\lim_{k\to\infty}x^k = \begin{cases} \infty &amp; \text{if } x&gt;1\\ 1 &amp; \text{if } x=1\\ 0 &amp; \text{if } -1 &lt; x &lt; 1\\ \text{does not exist} &amp; \text{if } x\leq -1\end{cases}
\end{split}\]</div>
<p>Hence, we can expect to have a finite limit <span class="math notranslate nohighlight">\(\boldsymbol{A}^k\)</span> as <span class="math notranslate nohighlight">\(k\to \infty\)</span> if the diagonal entries of <span class="math notranslate nohighlight">\(a_1,\dots,a_n\)</span> of <span class="math notranslate nohighlight">\(\boldsymbol{A}\)</span> satisfy <span class="math notranslate nohighlight">\(|a_i|&lt;1\)</span> or <span class="math notranslate nohighlight">\(a_i = 1\)</span> for all <span class="math notranslate nohighlight">\(i=1,\dots,n\)</span>.
Otherwise, the matrix <span class="math notranslate nohighlight">\(\boldsymbol{A}^k\)</span> will either oscillate or diverge as <span class="math notranslate nohighlight">\(k\to\infty\)</span>.
Let’s see an example with our matrix <span class="math notranslate nohighlight">\(\boldsymbol{A}\)</span> from above.</p>
<p>To get an idea of what <span class="math notranslate nohighlight">\(\boldsymbol{A}^k\)</span> is as <span class="math notranslate nohighlight">\(k\to\infty\)</span>, let’s try computing <span class="math notranslate nohighlight">\(\boldsymbol{A}^{10}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">Ak</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_power</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<span class="n">Ak</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[          1,           0,           0,           0,           0,
                  0,           0,           0,           0,           0],
       [          0,        1024,           0,           0,           0,
                  0,           0,           0,           0,           0],
       [          0,           0,       59049,           0,           0,
                  0,           0,           0,           0,           0],
       [          0,           0,           0,     1048576,           0,
                  0,           0,           0,           0,           0],
       [          0,           0,           0,           0,     9765625,
                  0,           0,           0,           0,           0],
       [          0,           0,           0,           0,           0,
           60466176,           0,           0,           0,           0],
       [          0,           0,           0,           0,           0,
                  0,   282475249,           0,           0,           0],
       [          0,           0,           0,           0,           0,
                  0,           0,  1073741824,           0,           0],
       [          0,           0,           0,           0,           0,
                  0,           0,           0,  3486784401,           0],
       [          0,           0,           0,           0,           0,
                  0,           0,           0,           0, 10000000000]])
</pre></div>
</div>
</div>
</div>
<p>As would expect based on our discussion above, the entries are growing very quickly.
On the other hand, let’s see what happens when we <em>rescale</em> the matrix <span class="math notranslate nohighlight">\(\boldsymbol{A}\)</span> between each successive multiplication.
In this case, a natural quantity to rescale a matrix <span class="math notranslate nohighlight">\(\boldsymbol{A}\)</span> by is the reciprocal of its largest diagonal entry, which in this case is <span class="math notranslate nohighlight">\(\frac{1}{10}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A_rescaled</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span><span class="o">*</span><span class="n">A</span>
<span class="n">A_rescaled_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_power</span><span class="p">(</span><span class="n">A_rescaled</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">A_rescaled_k</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00,
        0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00],
       [0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00,
        0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00],
       [0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00,
        0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00],
       [0.000e+00, 0.000e+00, 0.000e+00, 1.000e-04, 0.000e+00, 0.000e+00,
        0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00],
       [0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 1.000e-03, 0.000e+00,
        0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00],
       [0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 6.000e-03,
        0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00],
       [0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00,
        2.820e-02, 0.000e+00, 0.000e+00, 0.000e+00],
       [0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00,
        0.000e+00, 1.074e-01, 0.000e+00, 0.000e+00],
       [0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00,
        0.000e+00, 0.000e+00, 3.487e-01, 0.000e+00],
       [0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00, 0.000e+00,
        0.000e+00, 0.000e+00, 0.000e+00, 1.000e+00]])
</pre></div>
</div>
</div>
</div>
<p>Here, we rounded the matrix to <span class="math notranslate nohighlight">\(4\)</span> decimals to make it more readable.
We see that the entries aren’t growing, and are actually getting smaller, with the exception of <span class="math notranslate nohighlight">\(10\)</span>th diagonal which stays constant at <span class="math notranslate nohighlight">\(1\)</span>.
Let’s try what happens with <span class="math notranslate nohighlight">\(k=100\)</span> now to get a better idea for what the limiting matrix is.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">A_rescaled_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_power</span><span class="p">(</span><span class="n">A_rescaled</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">A_rescaled_k</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0., 0., 0., 0., 0., 1.]])
</pre></div>
</div>
</div>
</div>
<p>Here it is easy to see that the matrix <span class="math notranslate nohighlight">\(\boldsymbol{A}^k\)</span> converges to the matrix of all zeros except the last diagonal entry, which is still <span class="math notranslate nohighlight">\(1\)</span>.</p>
<p>This probably seems like a special situation, but it is very common—if you view the matrix the right way.</p>
</div>
</div>
<div class="section" id="powers-of-a-genenal-symmetric-matrix">
<h2><span class="section-number">4.3.2. </span>Powers of a genenal (symmetric) matrix<a class="headerlink" href="#powers-of-a-genenal-symmetric-matrix" title="Permalink to this headline">¶</a></h2>
<p>Let’s now consider how taking powers of matrices is similar/different when considering powers of a general (symmetric) matrix.</p>
<p>Let’s define a symmetric matrix <span class="math notranslate nohighlight">\(\boldsymbol{A}\)</span> to use in this section.
Here we use a trick to do this: for any matrix <span class="math notranslate nohighlight">\(\boldsymbol{B}\)</span>, the matrix <span class="math notranslate nohighlight">\(\boldsymbol{B}+\boldsymbol{B}^\top\)</span> is always symmetric.
(If we wanted, we could take advantage of the fact that for any matrix <span class="math notranslate nohighlight">\(\boldsymbol{B}\)</span>, the matrix <span class="math notranslate nohighlight">\(\boldsymbol{BB}^\top\)</span> is always symmetric; or we could use any symmetric matrix.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">26</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="n">A</span> <span class="o">=</span> <span class="mf">.5</span><span class="o">*</span><span class="p">(</span><span class="n">B</span> <span class="o">+</span> <span class="n">B</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1.,  4.,  7., 10., 13.],
       [ 4.,  7., 10., 13., 16.],
       [ 7., 10., 13., 16., 19.],
       [10., 13., 16., 19., 22.],
       [13., 16., 19., 22., 25.]])
</pre></div>
</div>
</div>
</div>
<p>The first fact about general symmetric matrices which we verify here is that for non-symmetric <span class="math notranslate nohighlight">\(\boldsymbol{A}\)</span>, it is emphatically <em>not</em> the case that <span class="math notranslate nohighlight">\(\boldsymbol{A}^k\)</span> is the same as taking the <span class="math notranslate nohighlight">\(k^{th}\)</span> power of each of the entries of <span class="math notranslate nohighlight">\(\boldsymbol{A}\)</span>.
Let’s check this for our case.</p>
<p>The entry-wise <span class="math notranslate nohighlight">\(k^{th}\)</span> power of <span class="math notranslate nohighlight">\(\boldsymbol{A}\)</span> is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">A</span><span class="o">**</span><span class="n">k</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[  1.,  16.,  49., 100., 169.],
       [ 16.,  49., 100., 169., 256.],
       [ 49., 100., 169., 256., 361.],
       [100., 169., 256., 361., 484.],
       [169., 256., 361., 484., 625.]])
</pre></div>
</div>
</div>
</div>
<p>While the <span class="math notranslate nohighlight">\(\boldsymbol{A}^k\)</span> is given by</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_power</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 335.,  440.,  545.,  650.,  755.],
       [ 440.,  590.,  740.,  890., 1040.],
       [ 545.,  740.,  935., 1130., 1325.],
       [ 650.,  890., 1130., 1370., 1610.],
       [ 755., 1040., 1325., 1610., 1895.]])
</pre></div>
</div>
</div>
</div>
<p>Indeed, these two matrices are very much not the same.
If we think about what matrix multiplication does, this of course makes sense: the <span class="math notranslate nohighlight">\((i,j)^{th}\)</span> entry of the product <span class="math notranslate nohighlight">\(\boldsymbol{AA}\)</span> depends on the entire <span class="math notranslate nohighlight">\(i^{th}\)</span> row and <span class="math notranslate nohighlight">\(j^{th}\)</span> column of <span class="math notranslate nohighlight">\(\boldsymbol{A}\)</span>, whereas the <span class="math notranslate nohighlight">\((i,j)^{th}\)</span> entry of the entry-wise square of <span class="math notranslate nohighlight">\(\boldsymbol{A}\)</span> only requires calculating <span class="math notranslate nohighlight">\(a_{ij}^2\)</span>.</p>
<div class="section" id="powers-of-a-genenal-symmetric-matrix-as-k-to-infty">
<h3><span class="section-number">4.3.2.1. </span>Powers of a genenal (symmetric) matrix as <span class="math notranslate nohighlight">\(k\to \infty\)</span><a class="headerlink" href="#powers-of-a-genenal-symmetric-matrix-as-k-to-infty" title="Permalink to this headline">¶</a></h3>
<p>For diagonal matrices, we saw that the power <span class="math notranslate nohighlight">\(\boldsymbol{A}^k\)</span> converges to a finite matrix only if we rescale things correctly.
Here, we will see that this is also true for general symmetric matrices, but that we need to be a bit careful about how we rescale them.</p>
<p>First, let’s verify that without rescaling, the matrix <span class="math notranslate nohighlight">\(\boldsymbol{A}^k\)</span> will diverge as <span class="math notranslate nohighlight">\(k\to\infty\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">Ak</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_power</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<span class="n">Ak</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[2.09676090e+17, 2.85810394e+17, 3.61944698e+17, 4.38079002e+17,
        5.14213306e+17],
       [2.85810394e+17, 3.89589396e+17, 4.93368399e+17, 5.97147401e+17,
        7.00926404e+17],
       [3.61944698e+17, 4.93368399e+17, 6.24792100e+17, 7.56215800e+17,
        8.87639501e+17],
       [4.38079002e+17, 5.97147401e+17, 7.56215800e+17, 9.15284199e+17,
        1.07435260e+18],
       [5.14213306e+17, 7.00926404e+17, 8.87639501e+17, 1.07435260e+18,
        1.26106570e+18]])
</pre></div>
</div>
</div>
</div>
<p>Here, <span class="math notranslate nohighlight">\(\boldsymbol{A}^k\)</span> diverges due to the specific matrix <span class="math notranslate nohighlight">\(\boldsymbol{A}\)</span>.  For other matrices, <span class="math notranslate nohighlight">\(\boldsymbol{A}^k\)</span> would converge to the all-zeros matrix.</p>
<p>Indeed, even for <span class="math notranslate nohighlight">\(k=10\)</span>, the matrix entries blow up.
So how should we rescale <span class="math notranslate nohighlight">\(\boldsymbol{A}\)</span> so that this doesn’t happen?
We might be inspired by the diagonal case and rescale the matrix by the reciprocal of the largest entry of <span class="math notranslate nohighlight">\(\boldsymbol{A}\)</span>, which in this case would be <span class="math notranslate nohighlight">\(\frac{1}{25}\)</span>.
Let’s see if this works by looking at <span class="math notranslate nohighlight">\((\frac{1}{25}\boldsymbol{A})^k\)</span> for <span class="math notranslate nohighlight">\(k=20\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="mi">20</span>

<span class="n">A_rescaled1</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mi">25</span><span class="p">)</span><span class="o">*</span><span class="n">A</span>
<span class="n">A_rescaled1_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_power</span><span class="p">(</span><span class="n">A_rescaled1</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<span class="n">A_rescaled1_k</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[7.83934358e+07, 1.06858435e+08, 1.35323434e+08, 1.63788433e+08,
        1.92253431e+08],
       [1.06858435e+08, 1.45659199e+08, 1.84459963e+08, 2.23260728e+08,
        2.62061492e+08],
       [1.35323434e+08, 1.84459963e+08, 2.33596493e+08, 2.82733023e+08,
        3.31869553e+08],
       [1.63788433e+08, 2.23260728e+08, 2.82733023e+08, 3.42205318e+08,
        4.01677613e+08],
       [1.92253431e+08, 2.62061492e+08, 3.31869553e+08, 4.01677613e+08,
        4.71485674e+08]])
</pre></div>
</div>
</div>
</div>
<p>Unfortunately, this idea doesn’t work—the entries still seem to blow up.
However, let’s try rescaling by the constant <span class="math notranslate nohighlight">\(\frac{1}{\lambda}\)</span> where <span class="math notranslate nohighlight">\(\lambda = 71.3104367\)</span>.
(We’ll see later why this particular rescaling makes sense.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">lam</span> <span class="o">=</span> <span class="mf">71.3104367</span>

<span class="n">A_rescaled2</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="n">lam</span><span class="p">)</span><span class="o">*</span><span class="n">A</span>
<span class="n">A_rescaled2_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_power</span><span class="p">(</span><span class="n">A_rescaled2</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<span class="n">A_rescaled2_k</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.06166205, 0.08405181, 0.10644157, 0.12883133, 0.15122109],
       [0.08405181, 0.11457139, 0.14509097, 0.17561054, 0.20613012],
       [0.10644157, 0.14509097, 0.18374036, 0.22238976, 0.26103916],
       [0.12883133, 0.17561054, 0.22238976, 0.26916898, 0.3159482 ],
       [0.15122109, 0.20613012, 0.26103916, 0.3159482 , 0.37085723]])
</pre></div>
</div>
</div>
</div>
<p>Things don’t seem to be blowing up this time, so let’s see what happens with <span class="math notranslate nohighlight">\(k=100\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">A_rescaled2_k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_power</span><span class="p">(</span><span class="n">A_rescaled2</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<span class="n">A_rescaled2_k</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.06166205, 0.08405181, 0.10644157, 0.12883133, 0.15122109],
       [0.08405181, 0.11457139, 0.14509097, 0.17561055, 0.20613013],
       [0.10644157, 0.14509097, 0.18374037, 0.22238977, 0.26103917],
       [0.12883133, 0.17561055, 0.22238977, 0.26916899, 0.31594821],
       [0.15122109, 0.20613013, 0.26103917, 0.31594821, 0.37085725]])
</pre></div>
</div>
</div>
</div>
<p>Indeed, taking higher powers doesn’t seem to be changing the matrix anymore, so this rescaling works to guarantee convergence of the matrix powers.
So, how did we come up with the mysterious constant <span class="math notranslate nohighlight">\(\lambda = 71.3104367\)</span>?
This turns out to be a special number which is the largest <em>eigenvalue</em> of <span class="math notranslate nohighlight">\(\boldsymbol{A}\)</span>.
We won’t be discussing the topic of eigenvalues until a bit later in the semester, but consider this some interesting motivation for the topics that we’ll study later on.
When we get to this topic later on, it will be more clear where this constant came from, and why rescaling by its reciprocal works.</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./content"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="basicLA_3_deconstructing.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">4.2. </span>Deconstructing Matrix Multiplication</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="basicLA_3B_chheader.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">5. </span>Matrices as transformations</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Michael W. Mahoney, N. Benjamin Erichson and Ryan Theisen<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>